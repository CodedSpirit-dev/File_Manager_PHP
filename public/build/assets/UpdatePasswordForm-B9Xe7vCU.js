import{r as n,j as s,a as v}from"./app-Dbza6AWq.js";import{u as C}from"./index.esm-DpAVc0lC.js";function q({className:S=""}){const p=n.useRef(null),c=n.useRef(null),[h,i]=n.useState(!1),[u,m]=n.useState(""),{register:t,handleSubmit:b,watch:w,setError:d,formState:{errors:r,isSubmitting:j,isValid:g},reset:l}=C({mode:"onChange",defaultValues:{current_password:"",password:"",password_confirmation:""}}),N=w("password");w("password_confirmation");const y=async a=>{var x,_,f;try{await v.put("/password/update",a),m("¡Contraseña actualizada con éxito!"),i(!0),l()}catch(o){if(o.response&&o.response.status===422){const e=o.response.data.errors;e.current_password&&(e.current_password.includes("The password is incorrect.")||e.current_password.includes("La contraseña actual es incorrecta.")?(m("Contraseña incorrecta"),i(!0),l({current_password:""}),(x=c.current)==null||x.focus()):(d("current_password",{type:"server",message:e.current_password[0]}),(_=c.current)==null||_.focus())),e.password&&(d("password",{type:"server",message:e.password[0]}),l({password:"",password_confirmation:""}),(f=p.current)==null||f.focus()),e.password_confirmation&&d("password_confirmation",{type:"server",message:e.password_confirmation[0]})}else console.error("An error occurred:",o)}};return s.jsxs("section",{children:[s.jsxs("header",{children:[s.jsx("h2",{className:"text-2xl font-bold text-center mt-4",children:"Actualizar contraseña"}),s.jsx("p",{className:"mt-1 text-sm text-gray-600 text-center",children:"Asegúrate de que tu cuenta esté usando una contraseña larga y aleatoria para mantenerla segura."})]}),s.jsxs("form",{onSubmit:b(y),className:"mt-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"current_password",className:"input__label",children:"Contraseña actual"}),s.jsx("input",{id:"current_password",...t("current_password",{required:"La contraseña actual es obligatoria"}),type:"password",className:"input__data__entry",autoComplete:"current-password",ref:a=>{t("current_password").ref(a),c.current=a}}),r.current_password&&s.jsx("p",{className:"text-red-600 mt-2",children:r.current_password.message})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"input__label",children:"Nueva contraseña"}),s.jsx("input",{id:"password",...t("password",{required:"La nueva contraseña es obligatoria",minLength:{value:8,message:"La contraseña debe tener al menos 8 caracteres"}}),type:"password",className:"input__data__entry",autoComplete:"new-password",ref:a=>{t("password").ref(a),p.current=a}}),r.password&&s.jsx("p",{className:"text-red-600 mt-2",children:r.password.message})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password_confirmation",className:"input__label",children:"Confirmar contraseña"}),s.jsx("input",{id:"password_confirmation",...t("password_confirmation",{required:"Debe confirmar la nueva contraseña",validate:a=>a===N||"Las contraseñas no coinciden"}),type:"password",className:"input__data__entry",autoComplete:"new-password"}),r.password_confirmation&&s.jsx("p",{className:"text-red-600 mt-2",children:r.password_confirmation.message})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsx("button",{type:"submit",disabled:!g||j,className:"btn btn-primary min-w-full max-w-xl",children:"Guardar"})})]}),h&&s.jsx("div",{className:"modal modal-open",children:s.jsxs("div",{className:"modal-box",children:[s.jsx("h3",{className:"font-bold text-lg",children:u}),s.jsx("div",{className:"modal-action",children:s.jsx("button",{className:"btn btn-primary",onClick:()=>{i(!1),u==="¡Contraseña actualizada con éxito!"&&window.location.reload()},children:"Aceptar"})})]})})]})}export{q as default};
