import{r as t,j as e,Y as C,b as E}from"./app-BuuRAISb.js";import{u as M,C as S}from"./index.esm-PsrZHC3J.js";function k(){const{control:u,handleSubmit:x,formState:{errors:r,isValid:b},reset:p}=M({mode:"onChange",defaultValues:{name:""}}),[h,j]=t.useState(""),[f,n]=t.useState(""),[g,l]=t.useState(!1),[N,o]=t.useState(!1),a=t.useRef(null),v=s=>{var m;(m=a.current)==null||m.close(),E.post("/admin/companies/store",s).then(()=>{j("La empresa ha sido registrada exitosamente."),n(""),l(!0),p()}).catch(y=>{var d;((d=y.response)==null?void 0:d.status)===450?n("El nombre de la empresa ya está en uso."):n("Hubo un error al registrar la empresa."),o(!0)})},c=()=>{var s;(s=a.current)==null||s.showModal()},i=()=>{var s;l(!1),o(!1),(s=a.current)==null||s.close()};return e.jsxs("div",{className:"container__25",children:[e.jsx(C,{title:"Registro de nuevas empresas"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),c()},children:[e.jsx("h1",{className:"text-2xl text-center font-bold my-4",children:"Registro de nuevas empresas"}),e.jsxs("div",{className:"mt-4 input__data__entry",children:[e.jsx(S,{name:"name",control:u,rules:{required:"El nombre es obligatorio",minLength:{value:3,message:"El nombre debe tener al menos 3 caracteres"},maxLength:{value:50,message:"El nombre no debe tener más de 50 caracteres"},pattern:{value:/^[a-zA-Z0-9\s]+$/,message:"El nombre no debe contener caracteres especiales"}},render:({field:s})=>e.jsx("input",{...s,className:`input__data__entry w-full ${r.name?"border-red-600":""}`,placeholder:"Nombre de la empresa"})}),r.name&&e.jsx("p",{className:"text-red-600",children:r.name.message})]}),e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsx("button",{className:"btn btn-block",type:"button",onClick:c,disabled:!b,children:"Registrar empresa"})})]}),e.jsx("dialog",{ref:a,id:"modal_company_confirm",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg text-center",children:"¿Estás seguro de registrar esta empresa?"}),e.jsxs("div",{className:"modal-action justify-center",children:[e.jsx("button",{className:"btn m-3 btn-info",onClick:()=>{var s;return(s=a.current)==null?void 0:s.close()},children:"No, cancelar"}),e.jsx("button",{className:"btn m-3 btn-warning",onClick:x(v),children:"Sí, registrar compañía"})]})]})}),g&&e.jsx("div",{className:"modal modal-open",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg text-center",children:"Registro de empresa"}),e.jsx("p",{className:"text-center",children:h}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{type:"button",className:"btn btn-info",onClick:i,children:"Aceptar"})})]})}),N&&e.jsx("div",{className:"modal modal-open",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"font-bold text-lg text-center",children:"Error al registrar empresa"}),e.jsx("p",{className:"text-center text-red-600",children:f}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn btn-info",onClick:i,children:"Cerrar"})})]})})]})}export{k as default};
