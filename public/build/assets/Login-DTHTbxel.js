import{a,r as x,j as e,Y as N,b as v}from"./app-Dbza6AWq.js";import{u as E}from"./index.esm-DpAVc0lC.js";import{u as _}from"./AuthProvider-9xkK5bBF.js";var f;const p=(f=document.querySelector('meta[name="csrf-token"]'))==null?void 0:f.getAttribute("content");p&&(a.defaults.headers.common["X-CSRF-TOKEN"]=p);a.defaults.withCredentials=!0;const S="/build/assets/cepac-01-DMt_tu9z.png";function I({status:n,canResetPassword:h}){const{user:g,hasPermission:C}=_(),i=g!==null,{register:o,handleSubmit:b,setError:l,setFocus:m,formState:{errors:t,isValid:j}}=E({mode:"onChange",defaultValues:{username:"",password:""}}),[c,d]=x.useState(!1);x.useEffect(()=>{i?window.location.href="/":m("username")},[i,m]);const y=async w=>{d(!0);try{await a.post("/login",w),window.location.href="/"}catch(s){if(s.response&&s.response.status===422){const r=s.response.data.errors;r?Object.keys(r).forEach(u=>{l(u,{type:"server",message:r[u][0]})}):l("username",{type:"server",message:s.response.data.message||"Error en el inicio de sesión"})}else console.error(s)}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Iniciar sesión"}),n&&e.jsx("div",{className:"mb-4 text-sm font-medium text-green-600",children:n}),e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs("form",{className:"container__25 bg-white p-6 rounded-md shadow-md mx-4 md:mx-0",onSubmit:b(y),children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:S,alt:"Logo",className:"h-20 w-auto"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Iniciar sesión"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Correo Electrónico"}),e.jsx("input",{id:"username",type:"email",autoComplete:"email",className:"input__data__entry",...o("username",{required:"El correo electrónico es requerido",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"El correo electrónico no es válido"}})}),t.username&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.username.message})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contraseña"}),e.jsx("input",{id:"password",type:"password",autoComplete:"current-password",className:"input__data__entry",...o("password",{required:"La contraseña es requerida"})}),t.password&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.password.message})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[h&&e.jsx(v,{href:"/password/reset",className:"text-sm text-gray-600 underline hover:text-gray-900",children:"¿Olvidaste tu contraseña?"}),e.jsxs("button",{type:"submit",className:"btn btn-block btn-primary flex items-center justify-center",disabled:!j||c,children:[c?e.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}):null,"Iniciar sesión"]})]})]})})]})}export{I as default};
