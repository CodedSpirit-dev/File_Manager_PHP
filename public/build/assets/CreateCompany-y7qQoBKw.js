import{r as a,j as e}from"./app-CYh5bE9e.js";import{u as _,C as F}from"./index.esm-CcO2mCQL.js";import{createCompany as L}from"./companyApi-c6awq_rb.js";function A({onClose:l,onSuccess:p}){const{control:j,handleSubmit:f,formState:{errors:n,isValid:i},reset:N,watch:g}=_({mode:"onChange",defaultValues:{name:""}}),[y,M]=a.useState(""),[C,c]=a.useState(""),[r,u]=a.useState(!1),t=a.useRef(null),d=a.useRef(null),m=a.useRef(null),v=g("name"),E=async s=>{var x,b,h;(x=t.current)==null||x.close(),u(!0);try{await L(s),M("Empresa registrada exitosamente."),c(""),(b=d.current)==null||b.showModal(),p(),N()}catch(o){if(o.response&&o.response.data&&o.response.data.errors){const k=o.response.data.errors,w=Object.values(k).flat().join(" ");c(w)}else c("Error en el registro de la empresa.");(h=m.current)==null||h.showModal()}finally{u(!1)}},S=()=>{var s;(s=d.current)==null||s.close(),l()},R=()=>{var s;(s=m.current)==null||s.close(),l()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"text-2xl text-center font-bold my-4",children:"Nueva Empresa"}),e.jsxs("form",{children:[e.jsx(F,{name:"name",control:j,rules:{required:"Nombre obligatorio",minLength:{value:3,message:"Mínimo 3 caracteres"},maxLength:{value:50,message:"Máximo 50 caracteres"}},render:({field:s})=>e.jsx("input",{...s,className:`input input-bordered w-full ${n.name?"border-red-600":""}`,placeholder:"Nombre de la empresa",disabled:r})}),n.name&&e.jsx("p",{className:"text-red-600",children:n.name.message}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",className:"btn-cancel",onClick:l,disabled:r,children:"Cancelar"}),e.jsx("button",{type:"button",className:`btn-accept ${!i||r?"btn-disabled":""}`,onClick:()=>{var s;return(s=t.current)==null?void 0:s.showModal()},disabled:!i||r,children:r?e.jsx("span",{className:"loading loading-spinner"}):"Registrar"})]})]})]}),e.jsx("dialog",{ref:t,id:"modal_company_confirm",className:"modal modal-bottom sm:modal-middle",children:e.jsxs("div",{className:"modal-box",children:[e.jsxs("h4",{className:"font-bold text-center",children:["¿Estás seguro de registrar a la empresa ",e.jsx("b",{children:v}),"?"]}),e.jsxs("div",{className:"modal-action justify-center",children:[e.jsx("button",{className:"btn-cancel",onClick:()=>{var s;return(s=t.current)==null?void 0:s.close()},children:"No, cancelar"}),e.jsx("button",{className:"btn-accept",onClick:f(E),children:"Sí, registrar empresa"})]})]})}),e.jsx("dialog",{ref:d,id:"modal_company_success",className:"modal modal-bottom sm:modal-middle",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-center",children:"Registro de Empresa"}),e.jsx("p",{className:"text-center text-success",children:y}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{type:"button",className:"btn btn-info",onClick:S,children:"Aceptar"})})]})}),e.jsx("dialog",{ref:m,id:"modal_company_error",className:"modal modal-bottom sm:modal-middle",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h4",{className:"font-bold text-center",children:"Error al Registrar Empresa"}),e.jsx("p",{className:"text-center text-error",children:C}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn-accept",onClick:R,children:"Cerrar"})})]})})]})}export{A as default};
