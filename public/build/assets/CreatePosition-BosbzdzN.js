import{r as a,b as d,j as e}from"./app-CIerHKvo.js";import{u as R,C as m}from"./index.esm-CXDWndR8.js";function F(){const{control:c,handleSubmit:u,formState:{errors:t,isValid:_},reset:f}=R({mode:"onChange",defaultValues:{name:"",company_id:"",hierarchy_level:""}}),[N,g]=a.useState([]),[v,y]=a.useState([]),[E,C]=a.useState(""),[M,h]=a.useState(""),[S,w]=a.useState(""),i=a.useRef(null),n=a.useRef(null),x=a.useRef(null),o=a.useRef(null),j=s=>{d.post(route("api.positions.store"),s).then(()=>{var r,l;C("El puesto ha sido registrado exitosamente."),f(),(r=o.current)==null||r.close(),(l=i.current)==null||l.showModal()}).catch(r=>{var l,p,b;((l=r.response)==null?void 0:l.status)===480?(h("El nombre del puesto ya está en uso."),(p=n.current)==null||p.showModal()):(h("Hubo un error al registrar el puesto."),(b=n.current)==null||b.showModal())})};return a.useEffect(()=>{d.get("api/companies").then(s=>g(s.data)).catch(s=>console.error("Error al cargar las empresas",s)),d.get("api/hierarchylevels").then(s=>y(s.data)).catch(s=>console.error("Error al cargar los niveles jerárquicos",s))},[]),e.jsxs("div",{className:"container__25",children:[e.jsxs("form",{onSubmit:u(j),children:[e.jsx("h1",{className:"text-2xl text-center font-bold my-4",children:"Registro de nuevos puestos"}),e.jsxs("div",{children:[e.jsxs("label",{className:"input__data__entry mt-10",htmlFor:"company_id",children:[e.jsx(m,{name:"company_id",control:c,rules:{required:"La empresa es obligatoria"},render:({field:s})=>e.jsxs("select",{...s,id:"company_id",className:"input__data__entry w-full",children:[e.jsx("option",{value:"",children:"Seleccione una empresa"}),N.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})}),t.company_id&&e.jsx("p",{className:"text-red-600",children:t.company_id.message})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"input__data__entry",htmlFor:"hierarchy_level",children:[e.jsx(m,{name:"hierarchy_level",control:c,rules:{required:"El nivel jerárquico es obligatorio"},render:({field:s})=>e.jsxs("select",{...s,id:"hierarchy_level",className:"input__data__entry w-full",children:[e.jsx("option",{value:"",children:"Seleccione un nivel jerárquico"}),v.map(r=>e.jsx("option",{value:r.level,children:r.name},r.level))]})}),t.hierarchy_level&&e.jsx("p",{className:"text-red-600",children:t.hierarchy_level.message})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"input__data__entry",htmlFor:"name",children:[e.jsx(m,{name:"name",control:c,rules:{required:"El nombre del puesto es obligatorio",minLength:{value:3,message:"El nombre debe tener al menos 3 caracteres"}},render:({field:s})=>e.jsx("input",{...s,placeholder:"Nombre del puesto",id:"name",className:"input__data__entry w-full"})}),t.name&&e.jsx("p",{className:"text-red-600",children:t.name.message})]})})]}),e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsx("button",{className:"btn btn-block",type:"button",onClick:()=>{var s;return(s=o.current)==null?void 0:s.showModal()},disabled:!_,children:"Registrar puesto"})})]}),e.jsx("dialog",{ref:o,id:"modal_position_confirm",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg text-center",children:"¿Estás seguro de registrar este puesto?"}),e.jsxs("div",{className:"modal-action justify-center",children:[e.jsx("button",{className:"btn m-3 btn-info",onClick:()=>{var s;return(s=o.current)==null?void 0:s.close()},children:"No, cancelar"}),e.jsx("button",{className:"btn m-3 btn-warning",onClick:u(j),children:"Sí, registrar puesto"})]})]})}),e.jsx("dialog",{ref:i,id:"modal_position_success",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"font-bold text-lg text-center",children:"Se ha registrado el puesto"}),e.jsx("h2",{className:"font-bold text-lg text-center text-green-600",children:E}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{var s;return(s=i.current)==null?void 0:s.close()},children:"Cerrar"})})]})}),e.jsx("dialog",{ref:n,id:"modal_position_error",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"font-bold text-lg text-center",children:"Error al registrar puesto"}),e.jsx("h2",{className:"text-center text-red-600",children:M}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn btn-info",onClick:()=>{var s;return(s=n.current)==null?void 0:s.close()},children:"Cerrar"})})]})}),e.jsx("dialog",{ref:x,id:"modal_position_name_error",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"font-bold text-lg text-center text-red-600",children:S}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn btn-info",onClick:()=>{var s;return(s=x.current)==null?void 0:s.close()},children:"Cerrar"})})]})})]})}export{F as default};
