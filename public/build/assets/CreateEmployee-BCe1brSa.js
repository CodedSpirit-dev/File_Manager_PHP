import{W as C,r as l,b as d,j as e,Y as y}from"./app-BDY2Wb-P.js";function q({}){const{data:a,setData:o,post:k,processing:p,reset:u}=C({first_name:"",last_name_1:"",last_name_2:"",username:"",password:"",password_confirmation:"",position_id:"",enable_permissions:!1,selected_permissions:[]}),[x,_]=l.useState([]),[j,b]=l.useState([]),[S,f]=l.useState({first_name:"",last_name_1:"",last_name_2:"",username:"",position_id:"",password:"",password_confirmation:""}),[r,c]=l.useState(1),g=2;l.useEffect(()=>{d.get("/api/positions").then(s=>{_(s.data)}).catch(s=>{console.error("Error al cargar los puestos",s)}),d.get("/api/permissions").then(s=>{b(s.data)}).catch(s=>{console.error("Error al cargar los permisos",s)})},[]);const N=s=>{const n=Number(s.target.value);s.target.checked?o("selected_permissions",[...a.selected_permissions,n]):o("selected_permissions",a.selected_permissions.filter(t=>t!==n))},i=s=>{o(s.target.name,s.target.value)},v=s=>{o(s.target.name,s.target.checked)},w=()=>{r>1&&c(r-1)},h=s=>{s.preventDefault(),r<g?c(r+1):d.post(route("admin.employees.store"),a).then(n=>{const t=n.data.id;a.enable_permissions?d.post("api/userpermissions",{employee_id:t,permissions:a.selected_permissions}).then(()=>{console.log("Permisos asignados correctamente"),u(),c(1)}).catch(m=>{console.error("Error al asignar los permisos",m)}):(u(),c(1))}).catch(n=>{var t,m;console.error("Error al guardar el empleado",n),(m=(t=n.response)==null?void 0:t.data)!=null&&m.errors&&f(n.response.data.errors)})};return e.jsxs("div",{className:"container__25",children:[e.jsx(y,{title:"Registro de nuevos empleados"}),e.jsxs("form",{onSubmit:h,children:[e.jsx("h1",{className:"text-2xl text-start font-bold my-4",children:"Registro de nuevos empleados"}),e.jsxs("ul",{className:"steps w-full",children:[e.jsx("li",{className:`step ${r>=1?"step-primary":""}`,children:"Registrar nuevo empleado"}),e.jsx("li",{className:`step ${r===2?"step-primary":""}`,children:"Elegir los permisos para el nuevo usuario"})]}),r===1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"first_name",name:"first_name",value:a.first_name,className:"w-full",placeholder:"Nombre(s)",onChange:i,required:!0})}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"last_name_1",name:"last_name_1",value:a.last_name_1,className:"w-full",placeholder:"Primer apellido",onChange:i,required:!0})}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"last_name_2",name:"last_name_2",value:a.last_name_2,className:"w-full",placeholder:"Segundo apellido",onChange:i,required:!0})}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"username",name:"username",value:a.username,className:"w-full",placeholder:"Nombre de usuario (CURP)",maxLength:18,onChange:i,required:!0})}),e.jsx("div",{className:"mt-4",children:e.jsxs("select",{id:"position_id",name:"position_id",value:a.position_id,className:"w-full",onChange:i,required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un puesto"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"password",type:"password",name:"password",value:a.password,className:"w-full",placeholder:"Contraseña",onChange:i,required:!0})}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{id:"password_confirmation",type:"password",name:"password_confirmation",value:a.password_confirmation,className:"w-full",placeholder:"Confirmar contraseña",onChange:i,required:!0})}),e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsx("button",{className:"btn btn-block",onClick:h,disabled:p,children:"Siguiente"})})]}),r===2&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsxs("label",{htmlFor:"enable_permissions",className:"input__label",children:["Habilitar permisos",e.jsx("input",{id:"enable_permissions",name:"enable_permissions",type:"checkbox",checked:a.enable_permissions,className:"ml-2 checkbox checkbox-primary",onChange:v})]})}),a.enable_permissions&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{children:"Seleccione los permisos:"}),j.map(s=>e.jsx("div",{className:"mt-2",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",value:s.id,checked:a.selected_permissions.includes(s.id),onChange:N,className:"checkbox checkbox-primary"}),s.permission_description]})},s.id))]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("button",{className:"btn btn-info",onClick:w,disabled:p,children:"Volver"}),e.jsx("button",{className:"btn btn-success",type:"submit",disabled:p,children:"Guardar empleado"})]})]})]})]})}export{q as default};
