import{r as a,b as d,j as e}from"./app-BV18XVG3.js";import{u as C,C as m}from"./index.esm-mNt4nw4V.js";function w(){const{control:o,handleSubmit:u,formState:{errors:t,isValid:_},reset:b}=C({mode:"onChange",defaultValues:{name:"",company_id:"",hierarchy_level:""}}),[f,g]=a.useState([]),[N,v]=a.useState([]),[y,E]=a.useState(""),[S,h]=a.useState(""),c=a.useRef(null),i=a.useRef(null),l=a.useRef(null),x=s=>{d.post("/api/positions",s).then(()=>{var r,n;E("El puesto ha sido registrado exitosamente."),b(),(r=l.current)==null||r.close(),(n=c.current)==null||n.showModal()}).catch(r=>{var n,p,j;(n=l.current)==null||n.close(),((p=r.response)==null?void 0:p.status)===480?h("El nombre del puesto ya está en uso."):h("Hubo un error al registrar el puesto."),(j=i.current)==null||j.showModal()})};return a.useEffect(()=>{d.get("admin/companies").then(s=>g(s.data)).catch(s=>console.error("Error al cargar las empresas",s)),d.get("api/hierarchylevels").then(s=>v(s.data)).catch(s=>console.error("Error al cargar los niveles jerárquicos",s))},[]),e.jsxs("div",{className:"container__25",children:[e.jsxs("form",{onSubmit:u(x),children:[e.jsx("h1",{className:"text-2xl text-center font-bold my-4",children:"Registro de nuevos puestos"}),e.jsxs("div",{children:[e.jsxs("label",{className:"input__data__entry mt-10",htmlFor:"company_id",children:[e.jsx(m,{name:"company_id",control:o,rules:{required:"La empresa es obligatoria"},render:({field:s})=>e.jsxs("select",{...s,id:"company_id",className:"input__data__entry w-full",children:[e.jsx("option",{value:"",children:"Seleccione una empresa"}),f.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})}),t.company_id&&e.jsx("p",{className:"text-red-600",children:t.company_id.message})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"input__data__entry",htmlFor:"hierarchy_level",children:[e.jsx(m,{name:"hierarchy_level",control:o,rules:{required:"El nivel jerárquico es obligatorio"},render:({field:s})=>e.jsxs("select",{...s,id:"hierarchy_level",className:"input__data__entry w-full",children:[e.jsx("option",{value:"",children:"Seleccione un nivel jerárquico"}),N.map(r=>e.jsx("option",{value:r.level,children:r.name},r.level))]})}),t.hierarchy_level&&e.jsx("p",{className:"text-red-600",children:t.hierarchy_level.message})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"input__data__entry",htmlFor:"name",children:[e.jsx(m,{name:"name",control:o,rules:{required:"El nombre del puesto es obligatorio",minLength:{value:3,message:"El nombre debe tener al menos 3 caracteres"}},render:({field:s})=>e.jsx("input",{...s,placeholder:"Nombre del puesto",id:"name",className:"input__data__entry w-full"})}),t.name&&e.jsx("p",{className:"text-red-600",children:t.name.message})]})})]}),e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsx("button",{className:"btn btn-block",type:"button",onClick:()=>{var s;return(s=l.current)==null?void 0:s.showModal()},disabled:!_,children:"Registrar puesto"})})]}),e.jsx("dialog",{ref:l,id:"modal_position_confirm",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg text-center",children:"¿Estás seguro de registrar este puesto?"}),e.jsxs("div",{className:"modal-action justify-center",children:[e.jsx("button",{className:"btn m-3 btn-info",onClick:()=>{var s;return(s=l.current)==null?void 0:s.close()},children:"No, cancelar"}),e.jsx("button",{className:"btn m-3 btn-warning",onClick:u(x),children:"Sí, registrar puesto"})]})]})}),e.jsx("dialog",{ref:c,id:"modal_position_success",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"font-bold text-lg text-center",children:"Se ha registrado el puesto"}),e.jsx("h2",{className:"font-bold text-lg text-center text-green-600",children:y}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{var s;return(s=c.current)==null?void 0:s.close()},children:"Cerrar"})})]})}),e.jsx("dialog",{ref:i,id:"modal_position_error",className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h1",{className:"font-bold text-lg text-center",children:"Error al registrar puesto"}),e.jsx("h2",{className:"text-center text-red-600",children:S}),e.jsx("div",{className:"modal-action justify-center",children:e.jsx("button",{className:"btn btn-info",onClick:()=>{var s;return(s=i.current)==null?void 0:s.close()},children:"Cerrar"})})]})})]})}export{w as default};
