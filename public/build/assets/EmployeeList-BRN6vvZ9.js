import{r as a,b as d,j as e}from"./app-CtACpcDW.js";import C from"./EditEmployee-BXPcurDQ.js";import k from"./CreateEmployee-Bzi6h3c7.js";import"./index.esm-CTsuotGp.js";const O=()=>{const[u,b]=a.useState([]),[r,j]=a.useState([]),[m,f]=a.useState([]),[g,o]=a.useState(!0),[x,y]=a.useState(null),[p,N]=a.useState(null),[E,h]=a.useState(!1),[_,l]=a.useState(!1),S=t=>{const s=r.find(i=>i.id===t.position_id),n=s?s.company_id:null;N({...t,company_id:n}),h(!0)};a.useEffect(()=>{c()},[]);const c=()=>{o(!0),Promise.all([d.get("admin/employees"),d.get("api/positions"),d.get("admin/companies")]).then(([t,s,n])=>{b(t.data),j(s.data),f(n.data),o(!1)}).catch(t=>{console.error("Error al cargar los datos",t),y("Error al cargar los datos"),o(!1)})},v=t=>{alert(`Funcionalidad de eliminación para ${t.first_name} ${t.last_name_1} está pendiente.`)};return g?e.jsx("div",{className:"flex justify-center items-center h-screen bg-base-100",children:e.jsx("span",{className:"loading loading-dots loading-lg text-primary"})}):x?e.jsx("div",{className:"text-center text-error",children:x}):e.jsxs("div",{className:"container mx-auto px-4 py-8 bg-base-100",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-center text-primary",children:"Lista de Empleados"}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx("button",{onClick:()=>l(!0),className:"btn btn-success",children:"Agregar Empleado"})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-primary-content",children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Nombre"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Fecha de Registro"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Último Inicio de Sesión"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Puesto"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Acciones"})]})}),e.jsx("tbody",{children:u.map(t=>{const s=r.find(i=>i.id===t.position_id),n=s?m.find(i=>i.id===s.company_id):null;return e.jsxs("tr",{className:"hover:bg-base-200",children:[e.jsxs("td",{className:"border px-4 py-2 text-sm text-base-content truncate",children:[t.first_name," ",t.last_name_1]}),e.jsx("td",{className:"border px-4 py-2 text-sm text-base-content",children:new Date(t.registered_at).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("td",{className:"border px-4 py-2 text-sm text-base-content",children:t.last_login_at?new Date(t.last_login_at).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"No registrado"}),e.jsxs("td",{className:"border px-4 py-2 text-sm text-base-content",children:[s==null?void 0:s.name,e.jsx("br",{}),n&&e.jsx("span",{className:"mt-1 inline-block bg-secondary text-secondary-content text-xs px-2 py-1 rounded",children:n.name})]}),e.jsx("td",{className:"border px-4 py-2 text-sm text-base-content",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>S(t),className:"btn btn-primary btn-sm",children:"Editar"}),e.jsx("button",{onClick:()=>v(t),className:"btn btn-error btn-sm text-base-100",children:"Eliminar"})]})})]},t.id)})})]}),E&&p&&e.jsx(C,{employee:p,positions:r,companies:m,onClose:()=>{h(!1),c()}}),_&&e.jsx("div",{className:"modal modal-open",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("button",{className:"btn btn-sm btn-circle absolute right-2 top-2",onClick:()=>l(!1),children:"✕"}),e.jsx(k,{onSuccess:()=>{l(!1),c()},onClose:()=>l(!1)})]})})]})]})};export{O as default};
